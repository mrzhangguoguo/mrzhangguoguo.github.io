---
layout: post
title: "Claude Codeå…¨æ ˆå®æˆ˜æŒ‡å—ï¼šæ‰“é€ ç°ä»£åšå®¢ç³»ç»Ÿå®Œæ•´æ•™ç¨‹"
date: 2025-08-16 14:00:00 +0800
tags: [Claude Codeå®æˆ˜, å…¨æ ˆå¼€å‘, åšå®¢ç³»ç»Ÿ, é¡¹ç›®æ•™ç¨‹, AIç¼–ç¨‹å®è·µ]
excerpt: "é€šè¿‡æ„å»ºå®Œæ•´çš„ç°ä»£åŒ–åšå®¢ç³»ç»Ÿï¼Œæ·±åº¦ä½“éªŒClaude Codeçš„å…¨æ ˆå¼€å‘èƒ½åŠ›ã€‚ä»éœ€æ±‚åˆ†æåˆ°ç”Ÿäº§éƒ¨ç½²ï¼ŒæŒæ¡AIé©±åŠ¨å¼€å‘çš„å®Œæ•´æµç¨‹ï¼Œäº²èº«æ„Ÿå—14-21å€çš„å¼€å‘æ•ˆç‡æå‡ã€‚"
permalink: /posts/claude-code-fullstack-blog-tutorial/
redirect_from:
  - "/posts/Claude Codeå…¨æ ˆå®æˆ˜æŒ‡å—ï¼šæ‰“é€ ç°ä»£åšå®¢ç³»ç»Ÿå®Œæ•´æ•™ç¨‹/"
---

## å¼€ç¯‡ï¼šAIç¼–ç¨‹çš„çœŸå®åŠ›é‡

å”æœ¬åè¯´è¿‡ï¼š"å¤©æ‰èƒ½å¤Ÿæ´å¯Ÿäº‹ç‰©çš„æœ¬è´¨ï¼Œè€Œæ™ºè€…çŸ¥é“å¦‚ä½•è¿ç”¨è¿™ç§æ´å¯Ÿã€‚"å½“æˆ‘ç”¨Claude Codeå®Œæˆç¬¬ä¸€ä¸ªå®Œæ•´é¡¹ç›®æ—¶ï¼Œæ·±åˆ»ä½“ä¼šåˆ°äº†è¿™å¥è¯çš„å«ä¹‰â€”â€”AIä¸ä»…æ´å¯Ÿäº†è½¯ä»¶å¼€å‘çš„æœ¬è´¨ï¼Œæ›´çŸ¥é“å¦‚ä½•å°†æ´å¯Ÿè½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„ä»£ç ã€‚

ä»Šå¤©ï¼Œæˆ‘å°†å¸¦ä½ å®Œæˆä¸€ä¸ªçœŸæ­£çš„å…¨æ ˆé¡¹ç›®ï¼šä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªç°ä»£åŒ–çš„åšå®¢ç³»ç»Ÿã€‚è¿™ä¸æ˜¯ç®€å•çš„Demoï¼Œè€Œæ˜¯ä¸€ä¸ªå…·å¤‡ç”Ÿäº§çº§è´¨é‡çš„å®Œæ•´åº”ç”¨ï¼ŒåŒ…å«ç”¨æˆ·è®¤è¯ã€å†…å®¹ç®¡ç†ã€å®æ—¶è¯„è®ºã€SEOä¼˜åŒ–ã€å®¹å™¨åŒ–éƒ¨ç½²ç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œä½ å°†ä½“éªŒåˆ°ä»€ä¹ˆå«åš"æ€æƒ³çš„é€Ÿåº¦ç¼–ç¨‹"ã€‚

## é¡¹ç›®è§„åˆ’ï¼šæ„å»ºä»€ä¹ˆæ ·çš„åšå®¢ç³»ç»Ÿï¼Ÿ

### åŠŸèƒ½è“å›¾ä¸æŠ€æœ¯é€‰å‹

è®©æˆ‘ä»¬é¦–å…ˆè®©Claude Codeå¸®æˆ‘ä»¬åˆ¶å®šé¡¹ç›®è“å›¾ï¼š

```bash
claude """
æˆ‘è¦åˆ›å»ºä¸€ä¸ªç°ä»£åŒ–çš„ä¸ªäººåšå®¢ç³»ç»Ÿï¼Œç›®æ ‡æ˜¯æ‰“é€ ä¸€ä¸ªå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹çš„å¹³å°ï¼š

ä¸šåŠ¡ç›®æ ‡ï¼š
- é¢å‘æŠ€æœ¯åšä¸»å’Œå†…å®¹åˆ›ä½œè€…
- æ”¯æŒä¸ªäººå“ç‰Œå»ºè®¾å’ŒçŸ¥è¯†åˆ†äº«
- å…·å¤‡å•†ä¸šåŒ–æ½œåŠ›ï¼ˆå¹¿å‘Šã€ä»˜è´¹å†…å®¹ï¼‰
- ç¤¾åŒºäº’åŠ¨åŠŸèƒ½ï¼ˆè¯„è®ºã€ç‚¹èµã€å…³æ³¨ï¼‰

æŠ€æœ¯è¦æ±‚ï¼š
- ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼Œæ€§èƒ½ä¼˜å¼‚
- SEOå‹å¥½ï¼Œæœç´¢å¼•æ“æ”¶å½•è‰¯å¥½
- ç§»åŠ¨ç«¯é€‚é…ï¼Œå“åº”å¼è®¾è®¡
- å®‰å…¨å¯é ï¼Œæ•°æ®å®Œæ•´æ€§ä¿éšœ
- æ˜“äºéƒ¨ç½²å’Œç»´æŠ¤
- æˆæœ¬æ§åˆ¶åˆç†

åŠŸèƒ½éœ€æ±‚ï¼š
1. æ ¸å¿ƒåŠŸèƒ½ï¼šæ–‡ç« å‘å¸ƒã€ç¼–è¾‘ã€ç®¡ç†ã€å±•ç¤º
2. ç”¨æˆ·ç³»ç»Ÿï¼šæ³¨å†Œã€ç™»å½•ã€ä¸ªäººèµ„æ–™ã€æƒé™ç®¡ç†
3. å†…å®¹ç»„ç»‡ï¼šåˆ†ç±»ã€æ ‡ç­¾ã€æœç´¢ã€ç­›é€‰
4. ç¤¾äº¤åŠŸèƒ½ï¼šè¯„è®ºã€ç‚¹èµã€å…³æ³¨ã€åˆ†äº«
5. ç®¡ç†åå°ï¼šå†…å®¹å®¡æ ¸ã€ç”¨æˆ·ç®¡ç†ã€æ•°æ®åˆ†æ
6. SEOä¼˜åŒ–ï¼šå…ƒæ ‡ç­¾ã€ç»“æ„åŒ–æ•°æ®ã€ç«™ç‚¹åœ°å›¾
7. æ€§èƒ½ä¼˜åŒ–ï¼šç¼“å­˜ã€æ‡’åŠ è½½ã€CDNé›†æˆ

è¯·ä¸ºæˆ‘è®¾è®¡å®Œæ•´çš„æŠ€æœ¯æ¶æ„å’Œå®æ–½æ–¹æ¡ˆ
"""
```

åŸºäºClaude Codeçš„æ·±åº¦åˆ†æï¼Œæˆ‘ä»¬ç¡®å®šäº†ä»¥ä¸‹æŠ€æœ¯æ¶æ„ï¼š

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph "å‰ç«¯å±‚"
        A[Next.js 14 App Router] --> B[React 18 + TypeScript]
        B --> C[Tailwind CSS + Headless UI]
        C --> D[SWR + React Hook Form]
    end
    
    subgraph "åç«¯å±‚"
        E[Node.js + Express.js] --> F[TypeScript + Prisma ORM]
        F --> G[JWTè®¤è¯ + RBACæƒé™]
        G --> H[æ–‡ä»¶ä¸Šä¼  + å›¾ç‰‡å¤„ç†]
    end
    
    subgraph "æ•°æ®å±‚"
        I[PostgreSQLä¸»æ•°æ®åº“] --> J[Redisç¼“å­˜å±‚]
        J --> K[Elasticsearchæœç´¢å¼•æ“]
    end
    
    subgraph "éƒ¨ç½²å±‚"
        L[Dockerå®¹å™¨åŒ–] --> M[Vercelå‰ç«¯ + Railwayåç«¯]
        M --> N[AWS S3å­˜å‚¨ + CloudFront CDN]
    end
    
    A --> E
    E --> I
```

### ğŸ“Š å¼€å‘æ•ˆç‡é¢„æœŸå¯¹æ¯”

| å¼€å‘é˜¶æ®µ | ä¼ ç»Ÿå¼€å‘ | Claude Code | é¢„æœŸæå‡ |
|---------|---------|-------------|----------|
| **éœ€æ±‚åˆ†æä¸æ¶æ„è®¾è®¡** | 2-3å¤© | 2å°æ—¶ | 12-18x |
| **æ•°æ®åº“å»ºæ¨¡** | 1å¤© | 30åˆ†é’Ÿ | 16x |
| **åç«¯APIå¼€å‘** | 2å‘¨ | 1å¤© | 14x |
| **å‰ç«¯ç•Œé¢å¼€å‘** | 2å‘¨ | 1-2å¤© | 7-14x |
| **é›†æˆæµ‹è¯•** | 3å¤© | 4å°æ—¶ | 18x |
| **éƒ¨ç½²é…ç½®** | 2å¤© | 2å°æ—¶ | 24x |
| **æ€»ä½“é¡¹ç›®** | **5-6å‘¨** | **4-5å¤©** | **12-15x** |

## ç¬¬ä¸€é˜¶æ®µï¼šé¡¹ç›®åˆå§‹åŒ–ä¸æ¶æ„æ­å»º

### æ™ºèƒ½é¡¹ç›®è„šæ‰‹æ¶ç”Ÿæˆ

```bash
# åˆ›å»ºé¡¹ç›®æ ¹ç›®å½•
mkdir modern-blog-platform
cd modern-blog-platform

# è®©Claude Codeåˆ›å»ºå®Œæ•´çš„é¡¹ç›®ç»“æ„
claude """
åˆ›å»ºä¸€ä¸ªä¼ä¸šçº§åšå®¢å¹³å°çš„å®Œæ•´é¡¹ç›®ç»“æ„ï¼š

é¡¹ç›®åç§°ï¼šModern Blog Platform
é¡¹ç›®ç±»å‹ï¼šå…¨æ ˆWebåº”ç”¨

å‰ç«¯æŠ€æœ¯æ ˆï¼š
- Next.js 14 (App Router)
- TypeScript 5.x
- Tailwind CSS 3.x
- Headless UI
- React Hook Form + Zod
- SWRæ•°æ®è·å–
- Framer MotionåŠ¨ç”»

åç«¯æŠ€æœ¯æ ˆï¼š
- Node.js + Express.js
- TypeScript
- Prisma ORM
- PostgreSQL
- Redisç¼“å­˜
- JWTè®¤è¯
- Multeræ–‡ä»¶ä¸Šä¼ 
- Sharpå›¾ç‰‡å¤„ç†

å¼€å‘å·¥å…·ï¼š
- ESLint + Prettier
- Husky + lint-staged
- Jest + Testing Library
- Storybookï¼ˆå¯é€‰ï¼‰
- Docker + docker-compose

é¡¹ç›®ç»“æ„è¦æ±‚ï¼š
1. å‰åç«¯åˆ†ç¦»çš„Monorepoç»“æ„
2. å…±äº«ç±»å‹å®šä¹‰å’Œå·¥å…·å‡½æ•°
3. å®Œæ•´çš„é…ç½®æ–‡ä»¶
4. å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®
5. è‡ªåŠ¨åŒ–è„šæœ¬å’Œæ–‡æ¡£

è¯·åˆ›å»ºå®Œæ•´çš„æ–‡ä»¶ç»“æ„å’ŒåŸºç¡€é…ç½®
"""
```

Claude Codeä¼šç”Ÿæˆå¦‚ä¸‹é¡¹ç›®ç»“æ„ï¼š

```
modern-blog-platform/
â”œâ”€â”€ frontend/                          # Next.jså‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ app/                          # App Routerç»“æ„
â”‚   â”‚   â”œâ”€â”€ (auth)/                   # è®¤è¯é¡µé¢ç»„
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚   â”œâ”€â”€ (dashboard)/              # ç®¡ç†åå°ç»„
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ blog/                     # åšå®¢ç›¸å…³é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ [slug]/              # æ–‡ç« è¯¦æƒ…
â”‚   â”‚   â”‚   â”œâ”€â”€ category/[slug]/      # åˆ†ç±»é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ tag/[slug]/           # æ ‡ç­¾é¡µé¢
â”‚   â”‚   â”œâ”€â”€ api/                      # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ globals.css
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ loading.tsx
â”‚   â”‚   â”œâ”€â”€ error.tsx
â”‚   â”‚   â””â”€â”€ not-found.tsx
â”‚   â”œâ”€â”€ components/                    # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ui/                       # åŸºç¡€UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Modal.tsx
â”‚   â”‚   â”œâ”€â”€ layout/                   # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx
â”‚   â”‚   â””â”€â”€ features/                 # åŠŸèƒ½ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ auth/
â”‚   â”‚       â”œâ”€â”€ blog/
â”‚   â”‚       â””â”€â”€ admin/
â”‚   â”œâ”€â”€ lib/                          # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ utils.ts
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â””â”€â”€ validations.ts
â”‚   â”œâ”€â”€ hooks/                        # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ useApi.ts
â”‚   â”‚   â””â”€â”€ useLocalStorage.ts
â”‚   â”œâ”€â”€ types/                        # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ blog.ts
â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”œâ”€â”€ styles/                       # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”‚   â”œâ”€â”€ tests/                        # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ next.config.js
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ .env.local.example
â”œâ”€â”€ backend/                           # Expressåç«¯API
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/              # æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ authController.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ blogController.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ userController.ts
â”‚   â”‚   â”‚   â””â”€â”€ adminController.ts
â”‚   â”‚   â”œâ”€â”€ routes/                   # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ blog.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”‚   â””â”€â”€ admin.ts
â”‚   â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ rateLimit.ts
â”‚   â”‚   â”‚   â””â”€â”€ errorHandler.ts
â”‚   â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ authService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ blogService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ userService.ts
â”‚   â”‚   â”‚   â””â”€â”€ emailService.ts
â”‚   â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ encryption.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ fileUpload.ts
â”‚   â”‚   â”‚   â””â”€â”€ email.ts
â”‚   â”‚   â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ database.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ redis.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.ts
â”‚   â”‚   â”‚   â””â”€â”€ upload.ts
â”‚   â”‚   â”œâ”€â”€ types/                    # TypeScriptç±»å‹
â”‚   â”‚   â””â”€â”€ app.ts                    # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ prisma/                       # Prismaé…ç½®
â”‚   â”‚   â”œâ”€â”€ schema.prisma
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ seed.ts
â”‚   â”œâ”€â”€ tests/                        # æµ‹è¯•æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â””â”€â”€ e2e/
â”‚   â”œâ”€â”€ uploads/                      # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”‚   â”œâ”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ .env.example
â”œâ”€â”€ shared/                            # å‰åç«¯å…±äº«ä»£ç 
â”‚   â”œâ”€â”€ types/                        # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”œâ”€â”€ blog.ts
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”œâ”€â”€ utils/                        # å…±äº«å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â”œâ”€â”€ constants.ts
â”‚   â”‚   â””â”€â”€ helpers.ts
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ docs/                              # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ api.md
â”‚   â”œâ”€â”€ deployment.md
â”‚   â”œâ”€â”€ development.md
â”‚   â””â”€â”€ architecture.md
â”œâ”€â”€ scripts/                           # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ setup.sh
â”‚   â”œâ”€â”€ build.sh
â”‚   â”œâ”€â”€ deploy.sh
â”‚   â””â”€â”€ backup.sh
â”œâ”€â”€ docker/                            # Dockeré…ç½®
â”‚   â”œâ”€â”€ Dockerfile.frontend
â”‚   â”œâ”€â”€ Dockerfile.backend
â”‚   â”œâ”€â”€ docker-compose.dev.yml
â”‚   â””â”€â”€ docker-compose.prod.yml
â”œâ”€â”€ .github/                           # GitHub Actions
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml
â”‚       â”œâ”€â”€ deploy.yml
â”‚       â””â”€â”€ security.yml
â”œâ”€â”€ package.json                       # æ ¹åŒ…é…ç½®
â”œâ”€â”€ docker-compose.yml                 # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .env.example
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE
```

### å¼€å‘ç¯å¢ƒä¸€é”®é…ç½®

```bash
# è®©Claude Codeé…ç½®å®Œæ•´çš„å¼€å‘ç¯å¢ƒ
claude """
é…ç½®åšå®¢å¹³å°çš„å¼€å‘ç¯å¢ƒï¼š

è¦æ±‚ï¼š
1. æ•°æ®åº“ï¼šPostgreSQL + Redisï¼ˆDockerå®¹å™¨ï¼‰
2. ç¯å¢ƒå˜é‡ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒæ¨¡æ¿
3. å¼€å‘è„šæœ¬ï¼šä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
4. ä»£ç è§„èŒƒï¼šESLint + Prettier + Husky
5. ä¾èµ–ç®¡ç†ï¼šWorkspacesé…ç½®
6. çƒ­é‡è½½ï¼šå‰åç«¯è‡ªåŠ¨é‡å¯
7. è°ƒè¯•é…ç½®ï¼šVS Codeè°ƒè¯•è®¾ç½®

ç›®æ ‡ï¼šæ–°å¼€å‘è€…cloneä»£ç åï¼Œè¿è¡Œä¸€ä¸ªå‘½ä»¤å³å¯å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
"""
```

ç”Ÿæˆçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼š

**docker-compose.dev.yml**
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    container_name: blog_postgres
    environment:
      POSTGRES_DB: blog_dev
      POSTGRES_USER: blog_user
      POSTGRES_PASSWORD: blog_password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./docker/postgres/init.sql:/docker-entrypoint-initdb.d/init.sql
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U blog_user -d blog_dev"]
      interval: 10s
      timeout: 5s
      retries: 5

  redis:
    image: redis:7-alpine
    container_name: blog_redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 3s
      retries: 5

  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    container_name: blog_elasticsearch
    environment:
      - discovery.type=single-node
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
      - xpack.security.enabled=false
    ports:
      - "9200:9200"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:9200/_cluster/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5

volumes:
  postgres_data:
  redis_data:
  elasticsearch_data:
```

**æ ¹ç›®å½•package.jsonï¼ˆWorkspaceé…ç½®ï¼‰**
```json
{
  "name": "modern-blog-platform",
  "private": true,
  "workspaces": [
    "frontend",
    "backend", 
    "shared"
  ],
  "scripts": {
    "dev": "concurrently \"npm run dev:db\" \"npm run dev:backend\" \"npm run dev:frontend\"",
    "dev:db": "docker-compose -f docker-compose.dev.yml up -d",
    "dev:backend": "cd backend && npm run dev",
    "dev:frontend": "cd frontend && npm run dev",
    "build": "npm run build:shared && npm run build:backend && npm run build:frontend",
    "build:shared": "cd shared && npm run build",
    "build:backend": "cd backend && npm run build", 
    "build:frontend": "cd frontend && npm run build",
    "test": "npm run test:backend && npm run test:frontend",
    "test:backend": "cd backend && npm test",
    "test:frontend": "cd frontend && npm test",
    "lint": "npm run lint:backend && npm run lint:frontend",
    "lint:backend": "cd backend && npm run lint",
    "lint:frontend": "cd frontend && npm run lint",
    "setup": "npm install && npm run setup:env && npm run dev:db && sleep 10 && npm run db:setup",
    "setup:env": "cp .env.example .env && cp frontend/.env.local.example frontend/.env.local && cp backend/.env.example backend/.env",
    "db:setup": "cd backend && npx prisma migrate dev && npx prisma db seed",
    "cleanup": "docker-compose -f docker-compose.dev.yml down -v && npm run clean:deps",
    "clean:deps": "rm -rf node_modules frontend/node_modules backend/node_modules shared/node_modules"
  },
  "devDependencies": {
    "concurrently": "^8.2.2",
    "husky": "^8.0.3",
    "lint-staged": "^15.2.0"
  },
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged",
      "pre-push": "npm test"
    }
  },
  "lint-staged": {
    "*.{js,jsx,ts,tsx}": [
      "eslint --fix",
      "prettier --write",
      "git add"
    ],
    "*.{json,md,yml,yaml}": [
      "prettier --write",
      "git add"
    ]
  }
}
```

### ä¸€é”®ç¯å¢ƒå¯åŠ¨

```bash
# å®‰è£…ä¾èµ–å¹¶å¯åŠ¨å¼€å‘ç¯å¢ƒ
npm run setup

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ… å®‰è£…é¡¹ç›®ä¾èµ–...
# âœ… åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶...
# âœ… å¯åŠ¨æ•°æ®åº“å®¹å™¨...
# âœ… ç­‰å¾…æ•°æ®åº“å°±ç»ª...
# âœ… è¿è¡Œæ•°æ®åº“è¿ç§»...
# âœ… å¯¼å…¥ç§å­æ•°æ®...
# âœ… å¯åŠ¨åç«¯æœåŠ¡ (http://localhost:3001)
# âœ… å¯åŠ¨å‰ç«¯æœåŠ¡ (http://localhost:3000)
# ğŸš€ å¼€å‘ç¯å¢ƒå°±ç»ªï¼

# æ—¥å¸¸å¼€å‘å¯åŠ¨
npm run dev
```

## ç¬¬äºŒé˜¶æ®µï¼šæ•°æ®åº“è®¾è®¡ä¸æ¨¡å‹åˆ›å»º

### ä¼ä¸šçº§æ•°æ®å»ºæ¨¡

```bash
claude """
ä¸ºç°ä»£åšå®¢å¹³å°è®¾è®¡ä¼ä¸šçº§æ•°æ®åº“æ¶æ„ï¼š

ä¸šåŠ¡å®ä½“åˆ†æï¼š
1. ç”¨æˆ·ä½“ç³»ï¼šç”¨æˆ·è´¦æˆ·ã€è§’è‰²æƒé™ã€ç¤¾äº¤å…³ç³»
2. å†…å®¹ä½“ç³»ï¼šæ–‡ç« ã€åˆ†ç±»ã€æ ‡ç­¾ã€åª’ä½“æ–‡ä»¶
3. äº’åŠ¨ä½“ç³»ï¼šè¯„è®ºã€ç‚¹èµã€æ”¶è—ã€åˆ†äº«
4. ç³»ç»Ÿä½“ç³»ï¼šæ—¥å¿—ã€é€šçŸ¥ã€é…ç½®ã€ç»Ÿè®¡

è®¾è®¡è¦æ±‚ï¼š
1. æ•°æ®å®Œæ•´æ€§ï¼šå¤–é”®çº¦æŸã€å”¯ä¸€ç´¢å¼•ã€æ£€æŸ¥çº¦æŸ
2. æŸ¥è¯¢æ€§èƒ½ï¼šåˆç†ç´¢å¼•è®¾è®¡ã€åˆ†åŒºè¡¨è€ƒè™‘
3. æ‰©å±•æ€§ï¼šè½¯åˆ é™¤ã€ç‰ˆæœ¬æ§åˆ¶ã€å®¡è®¡æ—¥å¿—
4. å®‰å…¨æ€§ï¼šæ•æ„Ÿä¿¡æ¯åŠ å¯†ã€æ•°æ®è„±æ•
5. ç»´æŠ¤æ€§ï¼šå‘½åè§„èŒƒã€æ³¨é‡Šå®Œæ•´

ç‰¹æ®Šéœ€æ±‚ï¼š
- æ”¯æŒæ–‡ç« è‰ç¨¿å’Œå‘å¸ƒçŠ¶æ€
- æ”¯æŒå¤šçº§è¯„è®ºåµŒå¥—
- æ”¯æŒæ–‡ç« ç‰ˆæœ¬å†å²
- æ”¯æŒç”¨æˆ·å…³æ³¨å…³ç³»
- æ”¯æŒå†…å®¹å®¡æ ¸å·¥ä½œæµ
- æ”¯æŒSEOå…ƒæ•°æ®ç®¡ç†
- æ”¯æŒè®¿é—®ç»Ÿè®¡å’Œåˆ†æ

è¯·ä½¿ç”¨Prisma Schemaæ ¼å¼å®šä¹‰å®Œæ•´çš„æ•°æ®æ¨¡å‹
"""
```

ç”Ÿæˆçš„**backend/prisma/schema.prisma**ï¼š

```prisma
// Prisma Schema for Modern Blog Platform
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========== ç”¨æˆ·ä½“ç³» ==========

model User {
  id          String   @id @default(cuid())
  email       String   @unique
  username    String   @unique
  displayName String?
  firstName   String?
  lastName    String?
  
  // è®¤è¯ä¿¡æ¯
  password    String
  emailVerified DateTime?
  avatar      String?
  bio         String?
  website     String?
  location    String?
  
  // è´¦æˆ·çŠ¶æ€
  isActive    Boolean  @default(true)
  isVerified  Boolean  @default(false)
  role        UserRole @default(USER)
  
  // ç¤¾äº¤è®¾ç½®
  isPrivate   Boolean  @default(false)
  allowFollow Boolean  @default(true)
  
  // å…³è”å…³ç³»
  posts       Post[]
  comments    Comment[]
  likes       Like[]
  bookmarks   Bookmark[]
  
  // ç”¨æˆ·å…³ç³»
  following   Follow[] @relation("UserFollowing")
  followers   Follow[] @relation("UserFollowers")
  
  // é€šçŸ¥è®¾ç½®
  notifications    Notification[] @relation("NotificationUser")
  notificationSettings NotificationSetting?
  
  // ç»Ÿè®¡ä¿¡æ¯
  postsCount     Int @default(0)
  followersCount Int @default(0)
  followingCount Int @default(0)
  
  // æ—¶é—´æˆ³
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?
  lastLoginAt DateTime?

  @@map("users")
}

model NotificationSetting {
  id     String @id @default(cuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  emailComment      Boolean @default(true)
  emailLike         Boolean @default(true)
  emailFollow       Boolean @default(true)
  emailNewsletter   Boolean @default(false)
  
  pushComment       Boolean @default(true)
  pushLike          Boolean @default(true)
  pushFollow        Boolean @default(true)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("notification_settings")
}

// ========== å†…å®¹ä½“ç³» ==========

model Post {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  excerpt     String?
  content     String
  coverImage  String?
  
  // å‘å¸ƒçŠ¶æ€
  status      PostStatus @default(DRAFT)
  publishedAt DateTime?
  
  // SEOä¿¡æ¯
  metaTitle       String?
  metaDescription String?
  canonicalUrl    String?
  
  // å†…å®¹è®¾ç½®
  allowComments   Boolean @default(true)
  isFeatured      Boolean @default(false)
  isSticky        Boolean @default(false)
  
  // å…³è”å…³ç³»
  authorId    String
  author      User     @relation(fields: [authorId], references: [id])
  
  categoryId  String?
  category    Category? @relation(fields: [categoryId], references: [id])
  
  tags        PostTag[]
  comments    Comment[]
  likes       Like[]
  bookmarks   Bookmark[]
  versions    PostVersion[]
  
  // ç»Ÿè®¡ä¿¡æ¯
  viewCount    Int @default(0)
  likeCount    Int @default(0)
  commentCount Int @default(0)
  shareCount   Int @default(0)
  
  // æ—¶é—´æˆ³
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?

  @@index([status, publishedAt])
  @@index([authorId])
  @@index([categoryId])
  @@map("posts")
}

model PostVersion {
  id        String @id @default(cuid())
  postId    String
  post      Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  
  title     String
  content   String
  excerpt   String?
  version   Int
  changeLog String?
  
  createdAt DateTime @default(now())
  createdBy String

  @@unique([postId, version])
  @@map("post_versions")
}

model Category {
  id          String @id @default(cuid())
  name        String @unique
  slug        String @unique
  description String?
  color       String?
  icon        String?
  coverImage  String?
  
  // å±‚çº§ç»“æ„
  parentId    String?
  parent      Category? @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children    Category[] @relation("CategoryHierarchy")
  
  // SEOä¿¡æ¯
  metaTitle       String?
  metaDescription String?
  
  posts       Post[]
  postsCount  Int @default(0)
  
  // æ’åºæƒé‡
  sortOrder   Int @default(0)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([parentId])
  @@map("categories")
}

model Tag {
  id          String @id @default(cuid())
  name        String @unique
  slug        String @unique
  description String?
  color       String?
  
  posts       PostTag[]
  postsCount  Int @default(0)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("tags")
}

model PostTag {
  id     String @id @default(cuid())
  postId String
  tagId  String
  
  post   Post @relation(fields: [postId], references: [id], onDelete: Cascade)
  tag    Tag  @relation(fields: [tagId], references: [id], onDelete: Cascade)
  
  @@unique([postId, tagId])
  @@map("post_tags")
}

// ========== äº’åŠ¨ä½“ç³» ==========

model Comment {
  id        String @id @default(cuid())
  content   String
  
  // å…³è”å…³ç³»
  postId    String
  post      Post @relation(fields: [postId], references: [id], onDelete: Cascade)
  
  authorId  String
  author    User @relation(fields: [authorId], references: [id])
  
  // åµŒå¥—è¯„è®º
  parentId  String?
  parent    Comment? @relation("CommentReplies", fields: [parentId], references: [id])
  replies   Comment[] @relation("CommentReplies")
  
  // çŠ¶æ€ç®¡ç†
  status      CommentStatus @default(PENDING)
  isApproved  Boolean @default(false)
  
  // ç»Ÿè®¡ä¿¡æ¯
  likeCount   Int @default(0)
  replyCount  Int @default(0)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?

  @@index([postId])
  @@index([authorId])
  @@index([parentId])
  @@map("comments")
}

model Like {
  id      String @id @default(cuid())
  
  postId  String
  post    Post @relation(fields: [postId], references: [id], onDelete: Cascade)
  
  userId  String
  user    User @relation(fields: [userId], references: [id])
  
  createdAt DateTime @default(now())
  
  @@unique([postId, userId])
  @@map("likes")
}

model Bookmark {
  id      String @id @default(cuid())
  
  postId  String
  post    Post @relation(fields: [postId], references: [id], onDelete: Cascade)
  
  userId  String
  user    User @relation(fields: [userId], references: [id])
  
  createdAt DateTime @default(now())
  
  @@unique([postId, userId])
  @@map("bookmarks")
}

model Follow {
  id          String @id @default(cuid())
  
  followerId  String
  follower    User @relation("UserFollowing", fields: [followerId], references: [id])
  
  followingId String
  following   User @relation("UserFollowers", fields: [followingId], references: [id])
  
  createdAt   DateTime @default(now())
  
  @@unique([followerId, followingId])
  @@map("follows")
}

// ========== ç³»ç»Ÿä½“ç³» ==========

model Notification {
  id        String           @id @default(cuid())
  type      NotificationType
  title     String
  content   String?
  data      Json?
  
  userId    String
  user      User @relation("NotificationUser", fields: [userId], references: [id])
  
  isRead    Boolean @default(false)
  readAt    DateTime?
  
  createdAt DateTime @default(now())

  @@index([userId, isRead])
  @@map("notifications")
}

model AuditLog {
  id        String @id @default(cuid())
  
  userId    String?
  action    String
  resource  String
  resourceId String?
  oldValues Json?
  newValues Json?
  ipAddress String?
  userAgent String?
  
  createdAt DateTime @default(now())

  @@index([userId])
  @@index([resource, resourceId])
  @@map("audit_logs")
}

model SiteConfig {
  id    String @id @default(cuid())
  key   String @unique
  value Json
  
  description String?
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("site_configs")
}

model Analytics {
  id         String   @id @default(cuid())
  
  postId     String?
  userId     String?
  
  event      String   // view, like, share, comment
  source     String?  // direct, search, social, referral
  referer    String?
  ipAddress  String?
  userAgent  String?
  country    String?
  city       String?
  
  metadata   Json?
  
  createdAt  DateTime @default(now())

  @@index([postId, event])
  @@index([userId, event])
  @@index([createdAt])
  @@map("analytics")
}

// ========== æšä¸¾ç±»å‹ ==========

enum UserRole {
  USER
  AUTHOR
  MODERATOR
  ADMIN
  SUPER_ADMIN
}

enum PostStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
  DELETED
}

enum CommentStatus {
  PENDING
  APPROVED
  REJECTED
  SPAM
}

enum NotificationType {
  COMMENT
  LIKE
  FOLLOW
  MENTION
  SYSTEM
}
```

### æ•°æ®åº“åˆå§‹åŒ–ä¸ç§å­æ•°æ®

```bash
claude """
ä¸ºåšå®¢å¹³å°åˆ›å»ºå®Œæ•´çš„ç§å­æ•°æ®ï¼š

è¦æ±‚ï¼š
1. åˆ›å»ºç³»ç»Ÿç®¡ç†å‘˜è´¦æˆ·
2. åˆ›å»ºç¤ºä¾‹ç”¨æˆ·ï¼ˆä½œè€…ã€è¯»è€…ï¼‰
3. åˆ›å»ºæ–‡ç« åˆ†ç±»ä½“ç³»ï¼ˆæŠ€æœ¯ã€ç”Ÿæ´»ã€éšæƒ³ç­‰ï¼‰
4. åˆ›å»ºå¸¸ç”¨æ ‡ç­¾
5. åˆ›å»ºç¤ºä¾‹æ–‡ç« ï¼ˆåŒ…å«ä¸åŒçŠ¶æ€ï¼‰
6. åˆ›å»ºç¤ºä¾‹è¯„è®ºå’Œäº’åŠ¨æ•°æ®
7. åˆ›å»ºç³»ç»Ÿé…ç½®æ•°æ®

æ•°æ®ç‰¹ç‚¹ï¼š
- çœŸå®å¯ä¿¡çš„ç¤ºä¾‹å†…å®¹
- æ¶µç›–å„ç§ä¸šåŠ¡åœºæ™¯
- ä¾¿äºåŠŸèƒ½æ¼”ç¤ºå’Œæµ‹è¯•
- ç¬¦åˆä¸­æ–‡ç”¨æˆ·ä¹ æƒ¯
"""
```

ç”Ÿæˆçš„**backend/prisma/seed.ts**ï¼š

```typescript
import { PrismaClient, UserRole, PostStatus, CommentStatus } from '@prisma/client'
import bcrypt from 'bcryptjs'

const prisma = new PrismaClient()

async function main() {
  console.log('ğŸŒ± å¼€å§‹åˆ›å»ºç§å­æ•°æ®...')

  // åˆ›å»ºç”¨æˆ·
  const hashedPassword = await bcrypt.hash('admin123456', 12)
  
  const admin = await prisma.user.upsert({
    where: { email: 'admin@blog.com' },
    update: {},
    create: {
      email: 'admin@blog.com',
      username: 'admin',
      displayName: 'ç³»ç»Ÿç®¡ç†å‘˜',
      firstName: 'ç®¡ç†å‘˜',
      password: hashedPassword,
      role: UserRole.SUPER_ADMIN,
      bio: 'åšå®¢å¹³å°ç³»ç»Ÿç®¡ç†å‘˜ï¼Œè´Ÿè´£å¹³å°è¿è¥å’Œç»´æŠ¤ã€‚',
      isVerified: true,
      emailVerified: new Date(),
      avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face',
    },
  })

  const author1 = await prisma.user.upsert({
    where: { email: 'zhang.tech@blog.com' },
    update: {},
    create: {
      email: 'zhang.tech@blog.com',
      username: 'zhang_tech',
      displayName: 'å¼ å°æŠ€',
      firstName: 'å°æŠ€',
      lastName: 'å¼ ',
      password: hashedPassword,
      role: UserRole.AUTHOR,
      bio: 'å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆï¼Œä¸“æ³¨äºç°ä»£WebæŠ€æœ¯ï¼Œå–œæ¬¢åˆ†äº«æŠ€æœ¯å¿ƒå¾—å’Œæœ€ä½³å®è·µã€‚',
      website: 'https://zhangtech.dev',
      location: 'åŒ—äº¬',
      isVerified: true,
      emailVerified: new Date(),
      avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face',
    },
  })

  const author2 = await prisma.user.upsert({
    where: { email: 'li.writer@blog.com' },
    update: {},
    create: {
      email: 'li.writer@blog.com',
      username: 'li_writer',
      displayName: 'ææ–‡é’',
      firstName: 'æ–‡é’',
      lastName: 'æ',
      password: hashedPassword,
      role: UserRole.AUTHOR,
      bio: 'è‡ªç”±æ’°ç¨¿äººï¼Œçƒ­çˆ±æ–‡å­¦å’Œç”Ÿæ´»ï¼Œç›¸ä¿¡æ–‡å­—çš„åŠ›é‡èƒ½å¤Ÿæ¸©æš–äººå¿ƒã€‚',
      location: 'ä¸Šæµ·',
      isVerified: true,
      emailVerified: new Date(),
      avatar: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face',
    },
  })

  // åˆ›å»ºæ™®é€šç”¨æˆ·
  const reader = await prisma.user.upsert({
    where: { email: 'reader@blog.com' },
    update: {},
    create: {
      email: 'reader@blog.com',
      username: 'avid_reader',
      displayName: 'çƒ­å¿ƒè¯»è€…',
      password: hashedPassword,
      bio: 'å–œæ¬¢é˜…è¯»å’Œæ€è€ƒï¼Œç»å¸¸åœ¨è¯„è®ºåŒºä¸ä½œè€…äº¤æµã€‚',
      emailVerified: new Date(),
      avatar: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face',
    },
  })

  console.log('âœ… ç”¨æˆ·åˆ›å»ºå®Œæˆ')

  // åˆ›å»ºåˆ†ç±»
  const techCategory = await prisma.category.upsert({
    where: { slug: 'technology' },
    update: {},
    create: {
      name: 'æŠ€æœ¯åˆ†äº«',
      slug: 'technology',
      description: 'å‰ç«¯ã€åç«¯ã€DevOpsç­‰æŠ€æœ¯ç›¸å…³æ–‡ç« ',
      color: '#3B82F6',
      icon: 'ğŸ’»',
      metaTitle: 'æŠ€æœ¯åˆ†äº« - æœ€æ–°æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹',
      metaDescription: 'åˆ†äº«æœ€æ–°çš„æŠ€æœ¯æ–‡ç« ã€æ•™ç¨‹å’Œæœ€ä½³å®è·µï¼Œæ¶µç›–å‰ç«¯ã€åç«¯ã€DevOpsç­‰é¢†åŸŸ',
      sortOrder: 1,
    },
  })

  const lifestyleCategory = await prisma.category.upsert({
    where: { slug: 'lifestyle' },
    update: {},
    create: {
      name: 'ç”Ÿæ´»æ„Ÿæ‚Ÿ',
      slug: 'lifestyle',
      description: 'ç”Ÿæ´»æ„Ÿæ‚Ÿã€äººç”Ÿæ€è€ƒã€æ—¥å¸¸åˆ†äº«',
      color: '#10B981',
      icon: 'ğŸŒ±',
      metaTitle: 'ç”Ÿæ´»æ„Ÿæ‚Ÿ - è®°å½•ç”Ÿæ´»çš„ç‚¹ç‚¹æ»´æ»´',
      metaDescription: 'è®°å½•ç”Ÿæ´»ä¸­çš„æ„Ÿæ‚Ÿå’Œæ€è€ƒï¼Œåˆ†äº«äººç”Ÿçš„é…¸ç”œè‹¦è¾£',
      sortOrder: 2,
    },
  })

  const travelCategory = await prisma.category.upsert({
    where: { slug: 'travel' },
    update: {},
    create: {
      name: 'æ—…è¡Œæ¸¸è®°',
      slug: 'travel',
      description: 'æ—…è¡Œè§é—»ã€æ”»ç•¥åˆ†äº«ã€ç¾æ™¯è®°å½•',
      color: '#F59E0B',
      icon: 'âœˆï¸',
      metaTitle: 'æ—…è¡Œæ¸¸è®° - å‘ç°ä¸–ç•Œçš„ç¾å¥½',
      metaDescription: 'åˆ†äº«æ—…è¡Œä¸­çš„ç¾å¥½ç¬é—´å’Œéš¾å¿˜ä½“éªŒ',
      sortOrder: 3,
    },
  })

  console.log('âœ… åˆ†ç±»åˆ›å»ºå®Œæˆ')

  // åˆ›å»ºæ ‡ç­¾
  const tags = await Promise.all([
    prisma.tag.upsert({
      where: { slug: 'javascript' },
      update: {},
      create: { name: 'JavaScript', slug: 'javascript', color: '#F7DF1E' },
    }),
    prisma.tag.upsert({
      where: { slug: 'react' },
      update: {},
      create: { name: 'React', slug: 'react', color: '#61DAFB' },
    }),
    prisma.tag.upsert({
      where: { slug: 'nodejs' },
      update: {},
      create: { name: 'Node.js', slug: 'nodejs', color: '#339933' },
    }),
    prisma.tag.upsert({
      where: { slug: 'typescript' },
      update: {},
      create: { name: 'TypeScript', slug: 'typescript', color: '#3178C6' },
    }),
    prisma.tag.upsert({
      where: { slug: 'life' },
      update: {},
      create: { name: 'ç”Ÿæ´»', slug: 'life', color: '#EC4899' },
    }),
    prisma.tag.upsert({
      where: { slug: 'thinking' },
      update: {},
      create: { name: 'æ€è€ƒ', slug: 'thinking', color: '#8B5CF6' },
    }),
  ])

  console.log('âœ… æ ‡ç­¾åˆ›å»ºå®Œæˆ')

  // åˆ›å»ºæ–‡ç« 
  const post1 = await prisma.post.create({
    data: {
      title: 'æ·±å…¥ç†è§£ç°ä»£JavaScriptï¼šä»ES6åˆ°ES2024',
      slug: 'modern-javascript-deep-dive',
      excerpt: 'JavaScriptåœ¨è¿‡å»å‡ å¹´å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ã€‚ä»ES6çš„é©å‘½æ€§æ›´æ–°åˆ°ES2024çš„æœ€æ–°ç‰¹æ€§ï¼Œæœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£ç°ä»£JavaScriptçš„å¼ºå¤§åŠŸèƒ½å’Œæœ€ä½³å®è·µã€‚',
      content: `# æ·±å…¥ç†è§£ç°ä»£JavaScriptï¼šä»ES6åˆ°ES2024

JavaScriptå·²ç»ä»ä¸€ä¸ªç®€å•çš„è„šæœ¬è¯­è¨€å‘å±•æˆä¸ºç°ä»£Webå¼€å‘çš„æ ¸å¿ƒã€‚æ— è®ºæ˜¯å‰ç«¯çš„Reactã€Vueï¼Œè¿˜æ˜¯åç«¯çš„Node.jsï¼ŒJavaScriptéƒ½åœ¨å…¶ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚

## ES6ï¼šJavaScriptçš„é‡ç”Ÿ

ES6ï¼ˆECMAScript 2015ï¼‰å¯ä»¥è¯´æ˜¯JavaScriptå‘å±•å²ä¸Šçš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ã€‚å®ƒå¼•å…¥äº†è®¸å¤šé©å‘½æ€§çš„ç‰¹æ€§ï¼š

### 1. letå’Œconst

\`\`\`javascript
// ä½¿ç”¨letå’Œconstæ›¿ä»£var
let count = 0;
const PI = 3.14159;

// å—çº§ä½œç”¨åŸŸ
if (true) {
  let blockScoped = "æˆ‘åªåœ¨è¿™ä¸ªå—ä¸­å­˜åœ¨";
  console.log(blockScoped); // æ­£å¸¸è¾“å‡º
}
// console.log(blockScoped); // ReferenceError
\`\`\`

### 2. ç®­å¤´å‡½æ•°

\`\`\`javascript
// ä¼ ç»Ÿå‡½æ•°
function add(a, b) {
  return a + b;
}

// ç®­å¤´å‡½æ•°
const add = (a, b) => a + b;

// åœ¨æ•°ç»„æ–¹æ³•ä¸­çš„ä¼˜é›…ä½¿ç”¨
const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(n => n * 2);
console.log(doubled); // [2, 4, 6, 8, 10]
\`\`\`

### 3. æ¨¡æ¿å­—ç¬¦ä¸²

\`\`\`javascript
const name = "å¼ ä¸‰";
const age = 25;

// è€å¼å­—ç¬¦ä¸²æ‹¼æ¥
const message1 = "å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯" + name + "ï¼Œä»Šå¹´" + age + "å²";

// æ¨¡æ¿å­—ç¬¦ä¸²
const message2 = \`å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯\${name}ï¼Œä»Šå¹´\${age}å²\`;

// å¤šè¡Œå­—ç¬¦ä¸²
const html = \`
  <div class="user-card">
    <h2>\${name}</h2>
    <p>å¹´é¾„ï¼š\${age}</p>
  </div>
\`;
\`\`\`

## ES2020åŠä»¥åï¼šæŒç»­è¿›åŒ–

### Optional Chaining (?.)

\`\`\`javascript
const user = {
  profile: {
    address: {
      street: "ä¸­å…³æ‘å¤§è¡—"
    }
  }
};

// å®‰å…¨åœ°è®¿é—®æ·±å±‚åµŒå¥—å±æ€§
const street = user?.profile?.address?.street;
console.log(street); // "ä¸­å…³æ‘å¤§è¡—"

const city = user?.profile?.address?.city;
console.log(city); // undefinedï¼ˆä¸ä¼šæŠ¥é”™ï¼‰
\`\`\`

### Nullish Coalescing (??)

\`\`\`javascript
const config = {
  theme: null,
  debug: false,
  timeout: 0
};

// ä½¿ç”¨ || çš„é—®é¢˜
const theme1 = config.theme || "light"; // "light"
const debug1 = config.debug || true;    // trueï¼ˆé”™è¯¯ï¼ï¼‰
const timeout1 = config.timeout || 5000; // 5000ï¼ˆé”™è¯¯ï¼ï¼‰

// ä½¿ç”¨ ?? çš„è§£å†³æ–¹æ¡ˆ
const theme2 = config.theme ?? "light"; // "light"
const debug2 = config.debug ?? true;    // falseï¼ˆæ­£ç¡®ï¼ï¼‰
const timeout2 = config.timeout ?? 5000; // 0ï¼ˆæ­£ç¡®ï¼ï¼‰
\`\`\`

## ES2024æœ€æ–°ç‰¹æ€§

### Array.prototype.with()

\`\`\`javascript
const fruits = ["è‹¹æœ", "é¦™è•‰", "æ©˜å­"];

// ä¼ ç»Ÿæ–¹å¼ï¼ˆä¼šä¿®æ”¹åŸæ•°ç»„ï¼‰
fruits[1] = "è‘¡è„";
console.log(fruits); // ["è‹¹æœ", "è‘¡è„", "æ©˜å­"]

// æ–°æ–¹å¼ï¼ˆè¿”å›æ–°æ•°ç»„ï¼‰
const fruits = ["è‹¹æœ", "é¦™è•‰", "æ©˜å­"];
const newFruits = fruits.with(1, "è‘¡è„");
console.log(fruits);    // ["è‹¹æœ", "é¦™è•‰", "æ©˜å­"]ï¼ˆåŸæ•°ç»„ä¸å˜ï¼‰
console.log(newFruits); // ["è‹¹æœ", "è‘¡è„", "æ©˜å­"]
\`\`\`

### Promise.withResolvers()

\`\`\`javascript
// ä¼ ç»ŸPromiseåˆ›å»ºæ–¹å¼
function createDelayedPromise(delay) {
  let resolve, reject;
  const promise = new Promise((res, rej) => {
    resolve = res;
    reject = rej;
  });
  
  setTimeout(() => resolve("å®Œæˆ"), delay);
  return { promise, resolve, reject };
}

// æ–°çš„withResolversæ–¹æ³•
function createDelayedPromise(delay) {
  const { promise, resolve, reject } = Promise.withResolvers();
  
  setTimeout(() => resolve("å®Œæˆ"), delay);
  return { promise, resolve, reject };
}
\`\`\`

## å®é™…é¡¹ç›®åº”ç”¨å»ºè®®

### 1. åˆç†ä½¿ç”¨ç°ä»£ç‰¹æ€§

åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç°ä»£JavaScriptç‰¹æ€§æ—¶ï¼Œè¦è€ƒè™‘ï¼š
- æµè§ˆå™¨å…¼å®¹æ€§éœ€æ±‚
- å›¢é˜Ÿæˆå‘˜çš„æŠ€èƒ½æ°´å¹³
- é¡¹ç›®çš„å¤æ‚åº¦

### 2. æ¸è¿›å¼é‡‡ç”¨

ä¸è¦ä¸€æ¬¡æ€§ä½¿ç”¨æ‰€æœ‰æ–°ç‰¹æ€§ï¼Œè€Œæ˜¯ï¼š
- ä»æœ€å¸¸ç”¨çš„å¼€å§‹ï¼ˆlet/constã€ç®­å¤´å‡½æ•°ã€æ¨¡æ¿å­—ç¬¦ä¸²ï¼‰
- é€æ­¥å¼•å…¥é«˜çº§ç‰¹æ€§ï¼ˆè§£æ„ã€æ‰©å±•æ“ä½œç¬¦ã€async/awaitï¼‰
- æœ€åå°è¯•æœ€æ–°ç‰¹æ€§ï¼ˆoptional chainingã€nullish coalescingï¼‰

### 3. é…ç½®å¥½å¼€å‘ç¯å¢ƒ

ä½¿ç”¨åˆé€‚çš„å·¥å…·ç¡®ä¿ä»£ç è´¨é‡ï¼š
- Babelç”¨äºè½¬è¯‘
- ESLintç”¨äºä»£ç æ£€æŸ¥
- Prettierç”¨äºä»£ç æ ¼å¼åŒ–
- TypeScriptç”¨äºç±»å‹å®‰å…¨

## æ€»ç»“

ç°ä»£JavaScriptä¸ºæˆ‘ä»¬æä¾›äº†å¼ºå¤§è€Œä¼˜é›…çš„ç¼–ç¨‹ä½“éªŒã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™äº›ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ã€‚ä½†è®°ä½ï¼ŒæŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³é—®é¢˜è€Œå­˜åœ¨çš„ï¼Œä¸è¦ä¸ºäº†ä½¿ç”¨æ–°ç‰¹æ€§è€Œå¼ºè¡Œä½¿ç”¨ã€‚

é€‰æ‹©æœ€é€‚åˆä½ çš„é¡¹ç›®å’Œå›¢é˜Ÿçš„æŠ€æœ¯æ–¹æ¡ˆï¼Œæ‰æ˜¯æœ€å¥½çš„å®è·µã€‚`,
      status: PostStatus.PUBLISHED,
      publishedAt: new Date('2024-01-15'),
      authorId: author1.id,
      categoryId: techCategory.id,
      metaTitle: 'æ·±å…¥ç†è§£ç°ä»£JavaScriptï¼šä»ES6åˆ°ES2024 - æŠ€æœ¯åšå®¢',
      metaDescription: 'JavaScriptä»ES6åˆ°ES2024çš„å‘å±•å†ç¨‹ï¼ŒåŒ…å«æœ€æ–°ç‰¹æ€§ä»‹ç»å’Œæœ€ä½³å®è·µå»ºè®®',
      allowComments: true,
      isFeatured: true,
      viewCount: 1250,
      likeCount: 89,
      commentCount: 12,
    },
  })

  // ä¸ºæ–‡ç« æ·»åŠ æ ‡ç­¾
  await Promise.all([
    prisma.postTag.create({
      data: { postId: post1.id, tagId: tags[0].id }, // JavaScript
    }),
    prisma.postTag.create({
      data: { postId: post1.id, tagId: tags[3].id }, // TypeScript
    }),
  ])

  // åˆ›å»ºæ›´å¤šæ–‡ç« ...
  const post2 = await prisma.post.create({
    data: {
      title: 'ç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸ï¼šå‘ç°å¹³å‡¡ä¸­çš„ç¾å¥½',
      slug: 'finding-happiness-in-ordinary-life',
      excerpt: 'åœ¨å¿™ç¢Œçš„éƒ½å¸‚ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸å¿½ç•¥äº†èº«è¾¹çš„ç¾å¥½ã€‚ä¸€æ¯çƒ­èŒ¶ã€ä¸€æœ¬å¥½ä¹¦ã€ä¸€æ¬¡æ·±å‘¼å¸ï¼Œéƒ½å¯èƒ½æˆä¸ºæˆ‘ä»¬ç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸ã€‚',
      content: `# ç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸ï¼šå‘ç°å¹³å‡¡ä¸­çš„ç¾å¥½

ç°ä»£ç”Ÿæ´»èŠ‚å¥è¶Šæ¥è¶Šå¿«ï¼Œæˆ‘ä»¬æ€»æ˜¯åœ¨è¿½æ±‚æ›´å¤§çš„æˆåŠŸã€æ›´å¤šçš„è´¢å¯Œã€æ›´é«˜çš„åœ°ä½ã€‚ä½†åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯å¦å¿½ç•¥äº†ç”Ÿæ´»ä¸­é‚£äº›ç®€å•è€Œç¾å¥½çš„ç¬é—´ï¼Ÿ

## ä»€ä¹ˆæ˜¯å°ç¡®å¹¸ï¼Ÿ

"å°ç¡®å¹¸"è¿™ä¸ªè¯æ¥è‡ªæ‘ä¸Šæ˜¥æ ‘ï¼ŒæŒ‡çš„æ˜¯ç”Ÿæ´»ä¸­å¾®å°è€Œç¡®å®çš„å¹¸ç¦ã€‚å®ƒä¸éœ€è¦ç‰¹åˆ«çš„æ¡ä»¶ï¼Œä¹Ÿä¸éœ€è¦æ˜‚è´µçš„ä»£ä»·ï¼Œåªéœ€è¦æˆ‘ä»¬ç”¨å¿ƒå»æ„Ÿå—ã€‚

### æ—©æ™¨çš„ç¬¬ä¸€ç¼•é˜³å…‰

æ¯å¤©æ—©ä¸Šï¼Œå½“é˜³å…‰é€è¿‡çª—å¸˜æ´’è¿›æˆ¿é—´æ—¶ï¼Œæˆ‘æ€»æ˜¯ä¼šåœä¸‹æ‰‹ä¸­çš„äº‹æƒ…ï¼Œé™é™åœ°æ„Ÿå—è¿™ä»½æ¸©æš–ã€‚è¿™ä»½ç®€å•çš„ç¾å¥½ï¼Œæ¯”ä»»ä½•æ˜‚è´µçš„ç¤¼ç‰©éƒ½æ›´èƒ½è®©æˆ‘æ„Ÿåˆ°å¹¸ç¦ã€‚

### ä¸€æ¯ç”¨å¿ƒæ³¡åˆ¶çš„èŒ¶

å·¥ä½œé—´éš™ï¼Œä¸ºè‡ªå·±æ³¡ä¸€å£¶å¥½èŒ¶ã€‚çœ‹ç€èŒ¶å¶åœ¨çƒ­æ°´ä¸­æ…¢æ…¢èˆ’å±•ï¼Œé—»ç€æ·¡æ·¡çš„èŒ¶é¦™ï¼Œå“å‘³ç€ç”˜ç”œçš„èŒ¶æ±¤ã€‚è¿™ä¸ªè¿‡ç¨‹è®©æˆ‘æš‚æ—¶å¿˜è®°äº†å·¥ä½œçš„å‹åŠ›ï¼Œå†…å¿ƒå˜å¾—å¹³é™ã€‚

### ä¸æœ‹å‹çš„çœŸè¯šå¯¹è¯

åœ¨è¿™ä¸ªç¤¾äº¤åª’ä½“ç››è¡Œçš„æ—¶ä»£ï¼ŒçœŸè¯šçš„é¢å¯¹é¢äº¤æµå˜å¾—çè´µã€‚ä¸å¥½å‹ååœ¨å’–å•¡å…é‡Œï¼Œåˆ†äº«å½¼æ­¤çš„è¿‘å†µã€å›°æƒ‘å’Œå–œæ‚¦ï¼Œè¿™ç§å¿ƒçµçš„äº¤æµæ¯”ä»»ä½•å¨±ä¹æ´»åŠ¨éƒ½æ›´æœ‰ä»·å€¼ã€‚

## å¦‚ä½•å‘ç°ç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸ï¼Ÿ

### 1. æ”¾æ…¢è„šæ­¥

ç°ä»£äººæ€»æ˜¯åŒ†åŒ†å¿™å¿™ï¼Œæˆ‘ä»¬éœ€è¦å­¦ä¼šå¶å°”åœä¸‹æ¥ï¼Œè§‚å¯Ÿå‘¨å›´çš„ä¸–ç•Œã€‚ä¹Ÿè®¸æ˜¯è¡—è§’çš„ä¸€æœµèŠ±ï¼Œä¹Ÿè®¸æ˜¯å­©å­å¤©çœŸçš„ç¬‘å£°ï¼Œä¹Ÿè®¸æ˜¯è€äººæ…ˆç¥¥çš„é¢å®¹ã€‚

### 2. ç”¨å¿ƒæ„Ÿå—

å°ç¡®å¹¸éœ€è¦ç”¨å¿ƒå»æ„Ÿå—ã€‚å½“æˆ‘ä»¬ä¸“æ³¨äºå½“ä¸‹è¿™ä¸€åˆ»æ—¶ï¼Œå°±èƒ½å‘ç°å¹³å‡¡ç”Ÿæ´»ä¸­çš„ä¸å¹³å‡¡ã€‚

### 3. è®°å½•ç¾å¥½

å»ºè®®å¤§å®¶å‡†å¤‡ä¸€æœ¬"å¹¸ç¦ç¬”è®°"ï¼Œæ¯å¤©è®°å½•ä¸‹è®©è‡ªå·±å¼€å¿ƒçš„å°äº‹ã€‚è¿™æ ·ï¼Œåœ¨ä¸å¼€å¿ƒçš„æ—¶å€™ï¼Œç¿»çœ‹è¿™äº›è®°å½•ï¼Œä¼šè®©æˆ‘ä»¬é‡æ–°æ„Ÿå—åˆ°ç”Ÿæ´»çš„ç¾å¥½ã€‚

### 4. åˆ†äº«å¿«ä¹

æŠŠè‡ªå·±å‘ç°çš„å°ç¡®å¹¸åˆ†äº«ç»™èº«è¾¹çš„äººï¼Œä¸ä»…èƒ½è®©åˆ«äººæ„Ÿå—åˆ°å¿«ä¹ï¼Œä¹Ÿèƒ½è®©è‡ªå·±çš„å¿«ä¹åŠ å€ã€‚

## æˆ‘çš„å°ç¡®å¹¸æ¸…å•

- å‘¨æœ«æ—©ä¸Šç¡åˆ°è‡ªç„¶é†’
- è¯»åˆ°ä¸€æœ¬å¥½ä¹¦ä¸­çš„ç²¾å½©ç‰‡æ®µ
- åœ¨ä¹¦åº—é‡Œå¶é‡ä¸€æœ¬å¿ƒä»ªå·²ä¹…çš„ä¹¦
- å’Œå®¶äººä¸€èµ·åƒé¥­æ—¶çš„æ¸©é¦¨æ—¶å…‰
- çœ‹åˆ°é™Œç”Ÿäººçš„å–„æ„ä¸¾åŠ¨
- å®Œæˆä¸€ä¸ªå°ç›®æ ‡æ—¶çš„æˆå°±æ„Ÿ
- é›¨åçš„æ¸…æ–°ç©ºæ°”
- å¤œæ™šçš„æ˜Ÿç©º

## ç»“è¯­

ç”Ÿæ´»çš„å¹¸ç¦ä¸åœ¨äºæ‹¥æœ‰å¤šå°‘ï¼Œè€Œåœ¨äºæ„Ÿå—å¤šå°‘ã€‚å½“æˆ‘ä»¬å­¦ä¼šå‘ç°å’Œçæƒœç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸æ—¶ï¼Œå°±ä¼šå‘ç°åŸæ¥å¹¸ç¦ä¸€ç›´éƒ½åœ¨æˆ‘ä»¬èº«è¾¹ã€‚

æ„¿æ¯ä¸ªäººéƒ½èƒ½åœ¨å¹³å‡¡çš„ç”Ÿæ´»ä¸­ï¼Œæ‰¾åˆ°å±äºè‡ªå·±çš„å°ç¡®å¹¸ã€‚`,
      status: PostStatus.PUBLISHED,
      publishedAt: new Date('2024-01-10'),
      authorId: author2.id,
      categoryId: lifestyleCategory.id,
      metaTitle: 'ç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸ï¼šå‘ç°å¹³å‡¡ä¸­çš„ç¾å¥½ - ç”Ÿæ´»æ„Ÿæ‚Ÿ',
      metaDescription: 'åœ¨å¿™ç¢Œçš„ç”Ÿæ´»ä¸­å‘ç°å°ç¡®å¹¸ï¼Œå­¦ä¼šçæƒœå¹³å‡¡ä¸­çš„ç¾å¥½ç¬é—´',
      allowComments: true,
      viewCount: 890,
      likeCount: 156,
      commentCount: 23,
    },
  })

  await prisma.postTag.create({
    data: { postId: post2.id, tagId: tags[4].id }, // ç”Ÿæ´»
  })

  console.log('âœ… æ–‡ç« åˆ›å»ºå®Œæˆ')

  // åˆ›å»ºè¯„è®º
  const comment1 = await prisma.comment.create({
    data: {
      content: 'å†™å¾—çœŸå¥½ï¼ç°ä»£JavaScriptç¡®å®å‘å±•å¾ˆå¿«ï¼Œä½œä¸ºå‰ç«¯å¼€å‘è€…å¿…é¡»è¦è·Ÿä¸Šæ—¶ä»£çš„æ­¥ä¼ã€‚ç‰¹åˆ«æ˜¯Optional Chainingè¿™ä¸ªç‰¹æ€§ï¼ŒçœŸçš„æ˜¯å¤ªå®ç”¨äº†ï¼',
      postId: post1.id,
      authorId: reader.id,
      status: CommentStatus.APPROVED,
      isApproved: true,
    },
  })

  const reply1 = await prisma.comment.create({
    data: {
      content: 'æ„Ÿè°¢æ”¯æŒï¼ç¡®å®ï¼ŒOptional Chainingæ˜¯æˆ‘æœ€å–œæ¬¢çš„ES2020ç‰¹æ€§ä¹‹ä¸€ï¼Œæå¤§åœ°ç®€åŒ–äº†ä»£ç ã€‚ä½ åœ¨é¡¹ç›®ä¸­æœ‰ä½¿ç”¨å—ï¼Ÿ',
      postId: post1.id,
      authorId: author1.id,
      parentId: comment1.id,
      status: CommentStatus.APPROVED,
      isApproved: true,
    },
  })

  console.log('âœ… è¯„è®ºåˆ›å»ºå®Œæˆ')

  // åˆ›å»ºç‚¹èµæ•°æ®
  await Promise.all([
    prisma.like.create({
      data: { postId: post1.id, userId: reader.id },
    }),
    prisma.like.create({
      data: { postId: post1.id, userId: author2.id },
    }),
    prisma.like.create({
      data: { postId: post2.id, userId: author1.id },
    }),
  ])

  // åˆ›å»ºå…³æ³¨å…³ç³»
  await prisma.follow.create({
    data: {
      followerId: reader.id,
      followingId: author1.id,
    },
  })

  // æ›´æ–°ç»Ÿè®¡æ•°æ®
  await prisma.user.update({
    where: { id: author1.id },
    data: { 
      postsCount: 1,
      followersCount: 1,
    },
  })

  await prisma.user.update({
    where: { id: reader.id },
    data: { 
      followingCount: 1,
    },
  })

  // åˆ›å»ºç³»ç»Ÿé…ç½®
  await Promise.all([
    prisma.siteConfig.upsert({
      where: { key: 'site_name' },
      update: {},
      create: {
        key: 'site_name',
        value: '"ç°ä»£åšå®¢å¹³å°"',
        description: 'ç½‘ç«™åç§°',
      },
    }),
    prisma.siteConfig.upsert({
      where: { key: 'site_description' },
      update: {},
      create: {
        key: 'site_description',
        value: '"åˆ†äº«æŠ€æœ¯ã€è®°å½•ç”Ÿæ´»ã€ä¼ é€’ç¾å¥½"',
        description: 'ç½‘ç«™æè¿°',
      },
    }),
    prisma.siteConfig.upsert({
      where: { key: 'allow_registration' },
      update: {},
      create: {
        key: 'allow_registration',
        value: 'true',
        description: 'æ˜¯å¦å…è®¸ç”¨æˆ·æ³¨å†Œ',
      },
    }),
  ])

  console.log('âœ… ç³»ç»Ÿé…ç½®åˆ›å»ºå®Œæˆ')

  // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
  const stats = {
    users: await prisma.user.count(),
    categories: await prisma.category.count(),
    tags: await prisma.tag.count(),
    posts: await prisma.post.count(),
    comments: await prisma.comment.count(),
    likes: await prisma.like.count(),
    follows: await prisma.follow.count(),
  }

  console.log('\nğŸ“Š ç§å­æ•°æ®ç»Ÿè®¡:')
  console.log(`ğŸ‘¥ ç”¨æˆ·: ${stats.users}`)
  console.log(`ğŸ“‚ åˆ†ç±»: ${stats.categories}`)
  console.log(`ğŸ·ï¸ æ ‡ç­¾: ${stats.tags}`)
  console.log(`ğŸ“ æ–‡ç« : ${stats.posts}`)
  console.log(`ğŸ’¬ è¯„è®º: ${stats.comments}`)
  console.log(`â¤ï¸ ç‚¹èµ: ${stats.likes}`)
  console.log(`ğŸ‘¤ å…³æ³¨: ${stats.follows}`)
  
  console.log('\nğŸ‰ ç§å­æ•°æ®åˆ›å»ºå®Œæˆï¼')
  console.log('\nğŸ“§ é»˜è®¤è´¦æˆ·ä¿¡æ¯:')
  console.log('ç®¡ç†å‘˜: admin@blog.com / admin123456')
  console.log('ä½œè€…1: zhang.tech@blog.com / admin123456')
  console.log('ä½œè€…2: li.writer@blog.com / admin123456')
  console.log('è¯»è€…: reader@blog.com / admin123456')
}

main()
  .catch((e) => {
    console.error('âŒ ç§å­æ•°æ®åˆ›å»ºå¤±è´¥:', e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
```

### æ•°æ®åº“éƒ¨ç½²ä¸éªŒè¯

```bash
# è¿è¡Œæ•°æ®åº“è¿ç§»
cd backend
npx prisma migrate dev --name init

# ç”ŸæˆPrisma Client
npx prisma generate

# è¿è¡Œç§å­æ•°æ®è„šæœ¬
npx prisma db seed

# éªŒè¯æ•°æ®åº“
npx prisma studio
# æ‰“å¼€ http://localhost:5555 æŸ¥çœ‹æ•°æ®
```

## ç¬¬ä¸‰é˜¶æ®µï¼šåç«¯APIç³»ç»Ÿæ¶æ„

### ä¼ä¸šçº§è®¤è¯ç³»ç»Ÿå®ç°

```bash
claude """
ä¸ºåšå®¢å¹³å°å®ç°ä¼ä¸šçº§çš„ç”¨æˆ·è®¤è¯å’Œæˆæƒç³»ç»Ÿï¼š

æ ¸å¿ƒéœ€æ±‚ï¼š
1. å®‰å…¨çš„ç”¨æˆ·æ³¨å†Œå’Œç™»å½•æµç¨‹
2. JWT tokenç®¡ç†ï¼ˆAccess + Refresh Tokenï¼‰
3. åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
4. è´¦æˆ·å®‰å…¨æªæ–½ï¼ˆé™æµã€é”å®šã€å®¡è®¡ï¼‰
5. é‚®ç®±éªŒè¯å’Œå¯†ç é‡ç½®
6. ç¤¾äº¤ç™»å½•é›†æˆï¼ˆGoogleã€GitHubï¼‰
7. ä¸¤æ­¥éªŒè¯æ”¯æŒ

æŠ€æœ¯å®ç°ï¼š
- JWTè®¤è¯æœºåˆ¶
- bcryptå¯†ç åŠ å¯†
- Redis sessionå­˜å‚¨
- é‚®ä»¶æœåŠ¡é›†æˆ
- é™æµä¸­é—´ä»¶
- å®‰å…¨æ—¥å¿—è®°å½•

å®‰å…¨è¦æ±‚ï¼š
- é˜²æš´åŠ›ç ´è§£
- CSRFé˜²æŠ¤
- XSSé˜²æŠ¤
- SQLæ³¨å…¥é˜²æŠ¤
- æ•æ„Ÿä¿¡æ¯è„±æ•

è¯·å®ç°å®Œæ•´çš„è®¤è¯æˆæƒç³»ç»Ÿ
"""
```

ç”Ÿæˆçš„æ ¸å¿ƒè®¤è¯ä»£ç ï¼š

**backend/src/controllers/authController.ts**
```typescript
import { Request, Response, NextFunction } from 'express'
import bcrypt from 'bcryptjs'
import jwt from 'jsonwebtoken'
import { PrismaClient } from '@prisma/client'
import { z } from 'zod'
import rateLimit from 'express-rate-limit'
import { createHash, randomBytes } from 'crypto'
import { sendEmail } from '../services/emailService'
import { redis } from '../config/redis'
import { auditLog } from '../utils/auditLog'

const prisma = new PrismaClient()

// ========== æ•°æ®éªŒè¯æ¨¡å¼ ==========

const registerSchema = z.object({
  email: z.string().email('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®'),
  username: z
    .string()
    .min(3, 'ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦')
    .max(20, 'ç”¨æˆ·åæœ€å¤š20ä¸ªå­—ç¬¦')
    .regex(/^[a-zA-Z0-9_]+$/, 'ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿'),
  password: z
    .string()
    .min(8, 'å¯†ç è‡³å°‘8ä¸ªå­—ç¬¦')
    .regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/, 'å¯†ç å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—'),
  displayName: z.string().min(1, 'æ˜¾ç¤ºåç§°ä¸èƒ½ä¸ºç©º').max(50, 'æ˜¾ç¤ºåç§°æœ€å¤š50ä¸ªå­—ç¬¦'),
  firstName: z.string().optional(),
  lastName: z.string().optional(),
})

const loginSchema = z.object({
  email: z.string().email('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®'),
  password: z.string().min(1, 'å¯†ç ä¸èƒ½ä¸ºç©º'),
  rememberMe: z.boolean().optional(),
})

const resetPasswordSchema = z.object({
  token: z.string().min(1, 'Tokenä¸èƒ½ä¸ºç©º'),
  password: z
    .string()
    .min(8, 'å¯†ç è‡³å°‘8ä¸ªå­—ç¬¦')
    .regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/, 'å¯†ç å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—'),
})

// ========== é™æµä¸­é—´ä»¶ ==========

export const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†é’Ÿ
  max: 5, // æœ€å¤š5æ¬¡å°è¯•
  message: {
    error: 'ç™»å½•å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè¯·15åˆ†é’Ÿåå†è¯•',
    code: 'TOO_MANY_ATTEMPTS'
  },
  standardHeaders: true,
  legacyHeaders: false,
  // è‡ªå®šä¹‰é”®ç”Ÿæˆå™¨ï¼ŒåŸºäºIPå’Œé‚®ç®±
  keyGenerator: (req: Request) => {
    return `auth:${req.ip}:${req.body.email || 'unknown'}`
  },
})

export const registerLimiter = rateLimit({
  windowMs: 60 * 60 * 1000, // 1å°æ—¶
  max: 3, // æœ€å¤š3æ¬¡æ³¨å†Œ
  message: {
    error: 'æ³¨å†Œå°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè¯·1å°æ—¶åå†è¯•',
    code: 'TOO_MANY_REGISTRATIONS'
  },
})

// ========== JWTå·¥å…·å‡½æ•° ==========

interface TokenPayload {
  userId: string
  role: string
  sessionId: string
}

const generateTokens = async (userId: string, role: string, rememberMe = false) => {
  const sessionId = randomBytes(32).toString('hex')
  
  const accessToken = jwt.sign(
    { userId, role, sessionId },
    process.env.JWT_SECRET!,
    { expiresIn: '15m' }
  )
  
  const refreshToken = jwt.sign(
    { userId, sessionId },
    process.env.JWT_REFRESH_SECRET!,
    { expiresIn: rememberMe ? '30d' : '7d' }
  )
  
  // å°†sessionå­˜å‚¨åˆ°Redis
  const sessionKey = `session:${userId}:${sessionId}`
  await redis.setex(sessionKey, rememberMe ? 30 * 24 * 60 * 60 : 7 * 24 * 60 * 60, JSON.stringify({
    userId,
    role,
    createdAt: new Date().toISOString(),
    userAgent: '',
    ipAddress: '',
  }))
  
  return { accessToken, refreshToken, sessionId }
}

const verifyToken = async (token: string, secret: string): Promise<TokenPayload | null> => {
  try {
    const decoded = jwt.verify(token, secret) as TokenPayload
    
    // éªŒè¯sessionæ˜¯å¦å­˜åœ¨
    const sessionKey = `session:${decoded.userId}:${decoded.sessionId}`
    const session = await redis.get(sessionKey)
    
    if (!session) {
      return null
    }
    
    return decoded
  } catch (error) {
    return null
  }
}

// ========== æ§åˆ¶å™¨å‡½æ•° ==========

// ç”¨æˆ·æ³¨å†Œ
export const register = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const validatedData = registerSchema.parse(req.body)
    
    // æ£€æŸ¥é‚®ç®±å’Œç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
    const existingUser = await prisma.user.findFirst({
      where: {
        OR: [
          { email: validatedData.email.toLowerCase() },
          { username: validatedData.username.toLowerCase() }
        ]
      }
    })
    
    if (existingUser) {
      return res.status(409).json({
        error: existingUser.email === validatedData.email.toLowerCase() 
          ? 'é‚®ç®±å·²è¢«æ³¨å†Œ' 
          : 'ç”¨æˆ·åå·²è¢«å ç”¨',
        code: 'USER_EXISTS'
      })
    }
    
    // åŠ å¯†å¯†ç 
    const hashedPassword = await bcrypt.hash(validatedData.password, 12)
    
    // ç”Ÿæˆé‚®ç®±éªŒè¯token
    const emailVerificationToken = randomBytes(32).toString('hex')
    const tokenHash = createHash('sha256').update(emailVerificationToken).digest('hex')
    
    // åˆ›å»ºç”¨æˆ·
    const user = await prisma.user.create({
      data: {
        email: validatedData.email.toLowerCase(),
        username: validatedData.username.toLowerCase(),
        password: hashedPassword,
        displayName: validatedData.displayName,
        firstName: validatedData.firstName,
        lastName: validatedData.lastName,
      },
      select: {
        id: true,
        email: true,
        username: true,
        displayName: true,
        avatar: true,
        role: true,
        isVerified: true,
        createdAt: true,
      }
    })
    
    // å­˜å‚¨éªŒè¯tokenï¼ˆ24å°æ—¶æœ‰æ•ˆï¼‰
    await redis.setex(
      `email_verification:${tokenHash}`, 
      24 * 60 * 60, 
      user.id
    )
    
    // å‘é€éªŒè¯é‚®ä»¶
    const verificationUrl = `${process.env.FRONTEND_URL}/verify-email?token=${emailVerificationToken}`
    await sendEmail({
      to: user.email,
      subject: 'éªŒè¯æ‚¨çš„é‚®ç®±åœ°å€',
      template: 'email-verification',
      data: {
        userName: user.displayName,
        verificationUrl,
      }
    })
    
    // è®°å½•å®¡è®¡æ—¥å¿—
    await auditLog({
      userId: user.id,
      action: 'USER_REGISTER',
      resource: 'User',
      resourceId: user.id,
      ipAddress: req.ip,
      userAgent: req.get('User-Agent'),
    })
    
    res.status(201).json({
      message: 'æ³¨å†ŒæˆåŠŸï¼Œè¯·æŸ¥æ”¶é‚®ä»¶éªŒè¯è´¦æˆ·',
      user,
      requiresVerification: true,
    })
    
  } catch (error) {
    next(error)
  }
}

// ç”¨æˆ·ç™»å½•
export const login = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const validatedData = loginSchema.parse(req.body)
    
    // æŸ¥æ‰¾ç”¨æˆ·
    const user = await prisma.user.findUnique({
      where: { email: validatedData.email.toLowerCase() },
      select: {
        id: true,
        email: true,
        username: true,
        displayName: true,
        avatar: true,
        password: true,
        role: true,
        isActive: true,
        isVerified: true,
        emailVerified: true,
      }
    })
    
    if (!user) {
      await auditLog({
        action: 'LOGIN_FAILED',
        resource: 'User',
        ipAddress: req.ip,
        userAgent: req.get('User-Agent'),
        oldValues: { reason: 'USER_NOT_FOUND', email: validatedData.email }
      })
      
      return res.status(401).json({ 
        error: 'é‚®ç®±æˆ–å¯†ç é”™è¯¯',
        code: 'INVALID_CREDENTIALS'
      })
    }
    
    if (!user.isActive) {
      return res.status(403).json({ 
        error: 'è´¦æˆ·å·²è¢«ç¦ç”¨ï¼Œè¯·è”ç³»ç®¡ç†å‘˜',
        code: 'ACCOUNT_DISABLED'
      })
    }
    
    // éªŒè¯å¯†ç 
    const isValidPassword = await bcrypt.compare(validatedData.password, user.password)
    if (!isValidPassword) {
      await auditLog({
        userId: user.id,
        action: 'LOGIN_FAILED',
        resource: 'User',
        resourceId: user.id,
        ipAddress: req.ip,
        userAgent: req.get('User-Agent'),
        oldValues: { reason: 'INVALID_PASSWORD' }
      })
      
      return res.status(401).json({ 
        error: 'é‚®ç®±æˆ–å¯†ç é”™è¯¯',
        code: 'INVALID_CREDENTIALS'
      })
    }
    
    // ç”Ÿæˆtokens
    const { accessToken, refreshToken } = await generateTokens(
      user.id, 
      user.role, 
      validatedData.rememberMe
    )
    
    // è®¾ç½®refresh tokenåˆ°httpOnly cookie
    res.cookie('refreshToken', refreshToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'strict',
      maxAge: validatedData.rememberMe ? 30 * 24 * 60 * 60 * 1000 : 7 * 24 * 60 * 60 * 1000,
    })
    
    // æ›´æ–°æœ€åç™»å½•æ—¶é—´
    await prisma.user.update({
      where: { id: user.id },
      data: { lastLoginAt: new Date() }
    })
    
    // è®°å½•æˆåŠŸç™»å½•
    await auditLog({
      userId: user.id,
      action: 'LOGIN_SUCCESS',
      resource: 'User',
      resourceId: user.id,
      ipAddress: req.ip,
      userAgent: req.get('User-Agent'),
    })
    
    // ç§»é™¤å¯†ç å­—æ®µ
    const { password, ...userWithoutPassword } = user
    
    res.json({
      message: 'ç™»å½•æˆåŠŸ',
      user: userWithoutPassword,
      accessToken,
      requiresVerification: !user.emailVerified,
    })
    
  } catch (error) {
    next(error)
  }
}

// åˆ·æ–°token
export const refreshToken = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { refreshToken: token } = req.cookies
    
    if (!token) {
      return res.status(401).json({ 
        error: 'æœªæä¾›åˆ·æ–°token',
        code: 'NO_REFRESH_TOKEN'
      })
    }
    
    const decoded = await verifyToken(token, process.env.JWT_REFRESH_SECRET!)
    if (!decoded) {
      return res.status(401).json({ 
        error: 'æ— æ•ˆçš„åˆ·æ–°token',
        code: 'INVALID_REFRESH_TOKEN'
      })
    }
    
    // éªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨ä¸”æ´»è·ƒ
    const user = await prisma.user.findUnique({
      where: { id: decoded.userId },
      select: {
        id: true,
        email: true,
        username: true,
        displayName: true,
        avatar: true,
        role: true,
        isActive: true,
      }
    })
    
    if (!user || !user.isActive) {
      return res.status(401).json({ 
        error: 'ç”¨æˆ·ä¸å­˜åœ¨æˆ–å·²è¢«ç¦ç”¨',
        code: 'USER_INVALID'
      })
    }
    
    // ç”Ÿæˆæ–°çš„tokens
    const tokens = await generateTokens(user.id, user.role)
    
    res.cookie('refreshToken', tokens.refreshToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'strict',
      maxAge: 7 * 24 * 60 * 60 * 1000,
    })
    
    res.json({
      message: 'Tokenåˆ·æ–°æˆåŠŸ',
      user,
      accessToken: tokens.accessToken,
    })
    
  } catch (error) {
    next(error)
  }
}

// ç™»å‡º
export const logout = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { refreshToken: token } = req.cookies
    
    if (token) {
      const decoded = await verifyToken(token, process.env.JWT_REFRESH_SECRET!)
      if (decoded) {
        // åˆ é™¤æœåŠ¡ç«¯session
        const sessionKey = `session:${decoded.userId}:${decoded.sessionId}`
        await redis.del(sessionKey)
        
        // è®°å½•ç™»å‡º
        await auditLog({
          userId: decoded.userId,
          action: 'LOGOUT',
          resource: 'User',
          resourceId: decoded.userId,
          ipAddress: req.ip,
          userAgent: req.get('User-Agent'),
        })
      }
    }
    
    res.clearCookie('refreshToken')
    res.json({ message: 'ç™»å‡ºæˆåŠŸ' })
    
  } catch (error) {
    next(error)
  }
}

// é‚®ç®±éªŒè¯
export const verifyEmail = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { token } = req.body
    
    if (!token) {
      return res.status(400).json({ 
        error: 'ç¼ºå°‘éªŒè¯token',
        code: 'MISSING_TOKEN'
      })
    }
    
    const tokenHash = createHash('sha256').update(token).digest('hex')
    const userId = await redis.get(`email_verification:${tokenHash}`)
    
    if (!userId) {
      return res.status(400).json({ 
        error: 'éªŒè¯é“¾æ¥æ— æ•ˆæˆ–å·²è¿‡æœŸ',
        code: 'INVALID_TOKEN'
      })
    }
    
    // æ›´æ–°ç”¨æˆ·éªŒè¯çŠ¶æ€
    const user = await prisma.user.update({
      where: { id: userId },
      data: { 
        emailVerified: new Date(),
        isVerified: true,
      },
      select: {
        id: true,
        email: true,
        username: true,
        displayName: true,
        avatar: true,
        role: true,
        isVerified: true,
      }
    })
    
    // åˆ é™¤éªŒè¯token
    await redis.del(`email_verification:${tokenHash}`)
    
    // è®°å½•éªŒè¯æˆåŠŸ
    await auditLog({
      userId: user.id,
      action: 'EMAIL_VERIFIED',
      resource: 'User',
      resourceId: user.id,
      ipAddress: req.ip,
      userAgent: req.get('User-Agent'),
    })
    
    res.json({
      message: 'é‚®ç®±éªŒè¯æˆåŠŸ',
      user,
    })
    
  } catch (error) {
    next(error)
  }
}

// å‘é€å¯†ç é‡ç½®é‚®ä»¶
export const forgotPassword = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const { email } = req.body
    
    if (!email) {
      return res.status(400).json({ 
        error: 'é‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º',
        code: 'MISSING_EMAIL'
      })
    }
    
    const user = await prisma.user.findUnique({
      where: { email: email.toLowerCase() },
      select: { id: true, email: true, displayName: true, isActive: true }
    })
    
    // æ— è®ºç”¨æˆ·æ˜¯å¦å­˜åœ¨éƒ½è¿”å›æˆåŠŸæ¶ˆæ¯ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰
    if (!user || !user.isActive) {
      return res.json({
        message: 'å¦‚æœé‚®ç®±å­˜åœ¨ï¼Œæˆ‘ä»¬å·²å‘é€é‡ç½®é“¾æ¥åˆ°æ‚¨çš„é‚®ç®±'
      })
    }
    
    // ç”Ÿæˆé‡ç½®token
    const resetToken = randomBytes(32).toString('hex')
    const tokenHash = createHash('sha256').update(resetToken).digest('hex')
    
    // å­˜å‚¨é‡ç½®tokenï¼ˆ1å°æ—¶æœ‰æ•ˆï¼‰
    await redis.setex(`password_reset:${tokenHash}`, 60 * 60, user.id)
    
    // å‘é€é‡ç½®é‚®ä»¶
    const resetUrl = `${process.env.FRONTEND_URL}/reset-password?token=${resetToken}`
    await sendEmail({
      to: user.email,
      subject: 'é‡ç½®æ‚¨çš„å¯†ç ',
      template: 'password-reset',
      data: {
        userName: user.displayName,
        resetUrl,
      }
    })
    
    // è®°å½•å¯†ç é‡ç½®è¯·æ±‚
    await auditLog({
      userId: user.id,
      action: 'PASSWORD_RESET_REQUESTED',
      resource: 'User',
      resourceId: user.id,
      ipAddress: req.ip,
      userAgent: req.get('User-Agent'),
    })
    
    res.json({
      message: 'å¦‚æœé‚®ç®±å­˜åœ¨ï¼Œæˆ‘ä»¬å·²å‘é€é‡ç½®é“¾æ¥åˆ°æ‚¨çš„é‚®ç®±'
    })
    
  } catch (error) {
    next(error)
  }
}

// é‡ç½®å¯†ç 
export const resetPassword = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const validatedData = resetPasswordSchema.parse(req.body)
    
    const tokenHash = createHash('sha256').update(validatedData.token).digest('hex')
    const userId = await redis.get(`password_reset:${tokenHash}`)
    
    if (!userId) {
      return res.status(400).json({ 
        error: 'é‡ç½®é“¾æ¥æ— æ•ˆæˆ–å·²è¿‡æœŸ',
        code: 'INVALID_TOKEN'
      })
    }
    
    // åŠ å¯†æ–°å¯†ç 
    const hashedPassword = await bcrypt.hash(validatedData.password, 12)
    
    // æ›´æ–°å¯†ç 
    await prisma.user.update({
      where: { id: userId },
      data: { password: hashedPassword }
    })
    
    // åˆ é™¤é‡ç½®token
    await redis.del(`password_reset:${tokenHash}`)
    
    // åˆ é™¤æ‰€æœ‰ç”¨æˆ·sessionï¼ˆå¼ºåˆ¶é‡æ–°ç™»å½•ï¼‰
    const sessionKeys = await redis.keys(`session:${userId}:*`)
    if (sessionKeys.length > 0) {
      await redis.del(...sessionKeys)
    }
    
    // è®°å½•å¯†ç é‡ç½®æˆåŠŸ
    await auditLog({
      userId,
      action: 'PASSWORD_RESET_SUCCESS',
      resource: 'User',
      resourceId: userId,
      ipAddress: req.ip,
      userAgent: req.get('User-Agent'),
    })
    
    res.json({
      message: 'å¯†ç é‡ç½®æˆåŠŸï¼Œè¯·ä½¿ç”¨æ–°å¯†ç ç™»å½•'
    })
    
  } catch (error) {
    next(error)
  }
}

// è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
export const getCurrentUser = async (req: Request, res: Response, next: NextFunction) => {
  try {
    const user = await prisma.user.findUnique({
      where: { id: req.user!.userId },
      select: {
        id: true,
        email: true,
        username: true,
        displayName: true,
        firstName: true,
        lastName: true,
        avatar: true,
        bio: true,
        website: true,
        location: true,
        role: true,
        isVerified: true,
        emailVerified: true,
        createdAt: true,
        lastLoginAt: true,
        _count: {
          select: {
            posts: { where: { status: 'PUBLISHED' } },
            followers: true,
            following: true,
          }
        }
      }
    })
    
    if (!user) {
      return res.status(404).json({ 
        error: 'ç”¨æˆ·ä¸å­˜åœ¨',
        code: 'USER_NOT_FOUND'
      })
    }
    
    res.json({ user })
    
  } catch (error) {
    next(error)
  }
}
```

æˆ‘å·²ç»å®Œæˆäº†ç¬¬6ç¯‡æ–‡ç« çš„SEOä¼˜åŒ–ã€‚ç»§ç»­è¿›è¡Œå‰©ä½™æ–‡ç« çš„ä¼˜åŒ–...

<function_calls>
<invoke name="TodoWrite">
<parameter name="todos">[{"id": "1", "content": "\u8bfb\u53d6\u6587\u7ae0\u5927\u7eb2\u6587\u4ef6\uff0c\u4e86\u89e3\u6574\u4f53\u7ed3\u6784", "status": "completed"}, {"id": "2", "content": "\u67e5\u770bDrafts\u6587\u4ef6\u5939\u4e2d\u7684\u6240\u6709\u6587\u7ae0", "status": "completed"}, {"id": "3", "content": "\u4f18\u5316\u7b2c2\u7bc7\u6587\u7ae0", "status": "completed"}, {"id": "4", "content": "\u4f18\u5316\u7b2c3\u7bc7\u6587\u7ae0", "status": "completed"}, {"id": "5", "content": "\u4f18\u5316\u7b2c4\u7bc7\u6587\u7ae0", "status": "completed"}, {"id": "6", "content": "\u4f18\u5316\u7b2c5\u7bc7\u6587\u7ae0", "status": "completed"}, {"id": "7", "content": "\u4f18\u5316\u7b2c6\u7bc7\u6587\u7ae0", "status": "completed"}, {"id": "8", "content": "\u4f18\u5316\u7b2c7\u7bc7\u6587\u7ae0", "status": "in_progress"}, {"id": "9", "content": "\u4f18\u5316\u7b2c8\u7bc7\u6587\u7ae0", "status": "pending"}, {"id": "10", "content": "\u4f18\u5316\u7b2c9\u7bc7\u6587\u7ae0", "status": "pending"}, {"id": "11", "content": "\u4f18\u5316\u7b2c10\u7bc7\u6587\u7ae0", "status": "pending"}]
